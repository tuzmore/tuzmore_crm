{% extends "base.html" %}
{% block title %}Register{% endblock %}
{% block content %}

<div class="flex justify-center items-center min-h-screen bg-gray-50 mt-6">
  <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-md">
    
    <!-- Title -->
    <h2 class="text-2xl font-bold text-center text-gray-800 mb-2">
      Create your Tuzmore Account
    </h2>
    <p class="text-center text-gray-500 mb-6 text-sm">
      Sign up to access your dashboard and tools.
    </p>

    <!-- Form -->
    <form id="registerForm" class="space-y-4">
      <input type="text" id="username" placeholder="Username" required
        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none">

      <input type="email" id="email" placeholder="Email address" required
        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none">

      <input type="password" id="password" placeholder="Password" required
        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none">

      <input type="password" id="password2" placeholder="Confirm password" required
        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none">

      <button type="submit"
        class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-300">
        Register
      </button>
    </form>

    <!-- Register Message -->
    <p id="registerMessage" class="mt-4 text-center text-sm"></p>

    <!-- Login Redirect -->
    <p class="text-center text-gray-600 mt-6 text-sm">
      Already have an account?
      <a href="{% url 'login' %}" class="text-blue-600 font-medium hover:underline">Log in</a>
    </p>
  </div>
</div>

<script>
document.getElementById("registerForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const data = {
    username: document.getElementById("username").value,
    email: document.getElementById("email").value,
    password: document.getElementById("password").value,
    password2: document.getElementById("password2").value
  };

  try {
    const res = await fetch("/api/register/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await res.json();
    const msg = document.getElementById("registerMessage");

    if (res.ok) {
      msg.textContent = "✅ Registration successful! Check your email to verify your account.";
      msg.className = "text-green-600 text-center mt-4";
      document.getElementById("registerForm").reset();
    } else {
      msg.textContent = result.detail || JSON.stringify(result);
      msg.className = "text-red-600 text-center mt-4";
    }
  } catch (error) {
    console.error(error);
    document.getElementById("registerMessage").textContent = "❌ Something went wrong. Try again.";
    document.getElementById("registerMessage").className = "text-red-600 text-center mt-4";
  }
});
</script>

{% endblock %}
